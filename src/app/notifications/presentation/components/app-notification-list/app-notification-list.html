<!-- app-notification-list.html -->
<div class="notification-badge"
     [class.has-notifications]="unreadCount > 0"
     (click)="toggleNotifications()">

  <!-- Icono de campana con contador -->
  <div class="bell-icon">
    ðŸ””
    <span *ngIf="unreadCount > 0" class="badge">
      {{ unreadCount > 99 ? '99+' : unreadCount }}
    </span>
  </div>

  <!-- Panel desplegable de notificaciones -->
  <div *ngIf="showPanel" class="notifications-panel">
    <div class="panel-header">
      <h4>{{ 'notifications.alerts'|translate }} - {{'notifications.vehicle'|translate}} {{vehicleId}}</h4>
      <button (click)="markAllAsRead()" *ngIf="unreadCount > 0" class="mark-all-btn">
        {{'notifications.markAll'|translate}}
      </button>
      <button (click)="toggleNotifications()" class="close-btn">Ã—</button>
    </div>

    <div class="connection-status" [class.connected]="isConnected">
      {{ isConnected ? ('notifications.connected'|translate) : ('notifications.disconnected'|translate) }}
    </div>

    <div class="notifications-list">
      <div *ngFor="let notif of vehicleNotifications"
           class="notification-item"
           [class.unread]="!notif.read"
           [class]="'severity-' + notif.severity.toLowerCase()">

        <div class="notification-content">
          <div class="notification-header">
            <strong>{{ "notifications.title"|translate }}:</strong>
            {{ notif.title }}
            <span class="notification-time">
              {{ notif.createdAt | date:'shortTime' }}
            </span>
          </div>

          <!-- Mostrar el mensaje completo -->
          <strong>{{ "notifications.message"|translate }}:</strong>
          <p class="notification-message">{{ notif.message }}</p>

          <!-- Mostrar detalles adicionales con traducciones -->
          <div class="notification-details" *ngIf="notif.message.includes('Severity:') || notif.message.includes('Type:')">
            <div *ngIf="notif.message.includes('Severity:')" class="detail-item">
              <strong>{{ 'notifications.severity' | translate }}:</strong> {{ extractValue(notif.message, 'Severity:') }}
            </div>
            <div *ngIf="notif.message.includes('Type:')" class="detail-item">
              <strong>{{ 'notifications.type' | translate }}:</strong> {{ extractValue(notif.message, 'Type:') }}
            </div>
          </div>
        </div>

        <button *ngIf="!notif.read"
                (click)="markAsRead(notif.id); $event.stopPropagation()"
                class="mark-read-btn"
                [title]="'Mark as read'">
          âœ“
        </button>
      </div>

      <div *ngIf="vehicleNotifications.length === 0" class="empty-state">
        {{"notifications.noVehicles" | translate}}
      </div>
    </div>
  </div>
</div>
